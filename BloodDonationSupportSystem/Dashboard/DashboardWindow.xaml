<Window x:Class="BloodDonationSupportSystem.Dashboard.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        Title="Dashboard Window" Height="650" Width="900"
        Background="#F0F4F8" FontFamily="Segoe UI"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header with Exit button and Title -->
        <DockPanel Grid.Row="0" Margin="0,0,0,20">
            <!-- Title -->
            <TextBlock Text="Admin Dashboard" FontSize="28" FontWeight="Bold" Foreground="#064663" VerticalAlignment="Center" DockPanel.Dock="Left" />

            <!-- Exit Button -->
            <Button Content="Thoát" Width="80" Height="30" DockPanel.Dock="Right" Margin="10,0,0,0" 
            Click="ExitButton_Click"
            Background="#2F855A" Foreground="White" FontWeight="SemiBold" BorderThickness="0" 
            Cursor="Hand" />
        </DockPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel -->
            <Border Grid.Column="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                <StackPanel>

                    <TextBlock Text="Tổng số người dùng:" FontWeight="Bold" Foreground="#0B3D91" FontSize="16" Margin="0,0,0,6"/>
                    <TextBlock x:Name="UserCountText" FontSize="22" FontWeight="SemiBold" Foreground="#064663" Margin="0,0,0,15"/>

                    <TextBlock Text="Đăng ký hiến máu:" FontWeight="Bold" Foreground="#0B3D91" FontSize="16" Margin="0,0,0,6"/>
                    <ListBox x:Name="DonationStatusList" Height="80" Margin="0,0,0,20" BorderBrush="#B0C4DE" Background="#F8FAFC" FontWeight="SemiBold" Foreground="#2A4365" />

                    <TextBlock Text="Tình trạng hiến máu" FontWeight="Bold" Foreground="#0B3D91" FontSize="16" Margin="0,0,0,6" />
                    <lvc:PieChart x:Name="DonationStatusChart" Height="270" Width="380" />
                </StackPanel>
            </Border>

            <!-- Right Panel -->
            <Border Grid.Column="1" Background="White" CornerRadius="8" Padding="15" Margin="10,0,0,0">
                <StackPanel>
                    <TextBlock Text="Tồn kho máu:" FontWeight="Bold" Foreground="#0B3D91" FontSize="16" Margin="0,0,0,6"/>
                    <ListBox x:Name="BloodInventoryList" Height="180" Margin="0,0,0,20" BorderBrush="#B0C4DE" Background="#F8FAFC" FontWeight="SemiBold" Foreground="#2A4365" />

                    <TextBlock Text="Yêu cầu khẩn cấp:" FontWeight="Bold" Foreground="#0B3D91" FontSize="16" Margin="0,0,0,6"/>
                    <ListBox x:Name="EmergencyList" Height="130" BorderBrush="#B0C4DE" Background="#F8FAFC" FontWeight="SemiBold" Foreground="#C53030" />

                    <!-- Export Excel Button with green color -->
                    <Button Content="Export Excel" Width="120" Height="35" Margin="10,20,0,0" HorizontalAlignment="Left"
                            Click="ExportExcelButton_Click"
                            Background="#2F855A" Foreground="White" FontWeight="SemiBold" BorderThickness="0" 
                            Cursor="Hand" />
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
