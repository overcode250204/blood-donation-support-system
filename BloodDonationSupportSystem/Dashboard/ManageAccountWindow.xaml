<Window x:Class="BloodDonationSupportSystem.Dashboard.ManageAccountWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="QUẢN LÝ TÀI KHOẢN" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI" 
        Background="#F5F7FA">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Width" Value="100"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Background" Value="#0B3D91"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Margin" Value="0 10 0 10"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D1D5DB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="True"/>
            <Setter Property="IsReadOnly" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="ColumnHeaderHeight" Value="40"/>
            <Setter Property="RowHeight" Value="36"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#0B3D91"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="10 5"/>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#D1D5DB"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0 0 0 15">
            <TextBlock Text="QUẢN LÝ TÀI KHOẢN" 
                       FontSize="22" FontWeight="Bold" 
                       Foreground="#0B3D91" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- DataGrid -->
        <Border Grid.Row="1" CornerRadius="4" BorderThickness="1" 
                BorderBrush="#D1D5DB" Background="White"
                Padding="1">
            <DataGrid x:Name="UsersDataGrid" 
                      ItemsSource="{Binding Users}"
                      RowEditEnding="UsersDataGrid_RowEditEnding"
                      PreviewKeyDown="UsersDataGrid_PreviewKeyDown">
                <DataGrid.Columns>
                    <!-- Full Name -->
                    <DataGridTextColumn Header="HỌ VÀ TÊN" Binding="{Binding FullName}" Width="180"/>

                    <!-- Phone Number -->
                    <DataGridTextColumn Header="SỐ ĐIỆN THOẠI" Binding="{Binding PhoneNumber}" Width="130"/>

                    <!-- Address -->
                    <DataGridTextColumn Header="ĐỊA CHỈ" Binding="{Binding Address}" Width="220"/>

                    <!-- Date of Birth -->
                    <DataGridTextColumn Header="NGÀY SINH" 
                                      Binding="{Binding DateOfBirth, StringFormat='dd/MM/yyyy'}" 
                                      Width="120"/>

                    <!-- Gender -->
                    <DataGridTemplateColumn Header="GIỚI TÍNH" Width="100">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Gender}" HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <ComboBox SelectedItem="{Binding Gender}" Width="90" HorizontalAlignment="Center">
                                    <sys:String>NAM</sys:String>
                                    <sys:String>NỮ</sys:String>
                                    <sys:String>KHÁC</sys:String>
                                </ComboBox>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>

                    <!-- Blood Type -->
                    <DataGridTextColumn Header="NHÓM MÁU" Binding="{Binding BloodType}" Width="100"/>

                    <!-- Role -->
                    <DataGridTemplateColumn Header="VAI TRÒ" Width="150">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Role.RoleName}" HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <ComboBox 
                                    ItemsSource="{Binding DataContext.Roles, RelativeSource={RelativeSource AncestorType=Window}}"
                                    SelectedValue="{Binding RoleId, Mode=TwoWay}"
                                    SelectedValuePath="RoleId"
                                    DisplayMemberPath="RoleName"
                                    Width="140"
                                    HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>

                    <!-- Status -->
                    <DataGridTemplateColumn Header="TRẠNG THÁI" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Status}" HorizontalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                        <DataGridTemplateColumn.CellEditingTemplate>
                            <DataTemplate>
                                <ComboBox SelectedItem="{Binding Status}" Width="110" HorizontalAlignment="Center">
                                    <sys:String>HOẠT ĐỘNG</sys:String>
                                    <sys:String>NGỪNG HOẠT ĐỘNG</sys:String>
                                </ComboBox>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellEditingTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 15 0 0">
            <Button Content="THÊM MỚI" Click="CreateButton_Click" 
                    Background="#0B3D91"/>

            <Button Content="XÓA" Click="DeleteButton_Click" 
                    Background="#D32F2F"/>

            <Button Content="LƯU THAY ĐỔI" Click="SaveButton_Click" 
                    Background="#388E3C" Width="140"/>

            <Button Content="TẢI LẠI" Click="ReloadButton_Click" 
                    Background="#0B3D91"/>

            <Button Content="ĐÓNG" Click="CloseButton_Click" 
                    Background="#6B7280"/>
        </StackPanel>
    </Grid>
</Window>